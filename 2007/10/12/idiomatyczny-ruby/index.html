<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="pl" xml:lang="pl">
  <head>
    <title>Idiomatyczny Ruby - Radarek bloguje... o Ruby</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="verify-v1" content="XvR5kxyBmJGgUb1Tca8kJ+ii1Vde81UrpDJptt6JMeU=" />
    <link rel="shortcut icon" href="../../../../files/favicon.png" type="image/png" />
    <meta name="keywords" content="idioms, ruby, tips, Ruby, Techblog, Tips &amp; tricks, , ruby, ruby on rails, rails, merb, jruby, yarv, rubinius, ironruby, maglev, programowanie, radarek, radosław bułat, radoslaw bulat, radoslaw, bulat, python, gamedev" />
    <meta name="description" content="Wszystko co wiem o programowaniu, przede wszystkim Ruby." />
    <meta name="robots" content="index,follow"/>

    <link rel="stylesheet" href="../../../../files/style.css" type="text/css" />
    <!--[if lte IE 6]><link rel="stylesheet" href="/files/style-ie6.css" type="text/css" /><![endif]-->
    <!--[if IE 7]><link rel="stylesheet" type="text/css" href="/files/style-ie7.css" /><![endif]-->

    <!--<script type="text/javascript" src="/files/jquery.js"></script>-->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script type="text/javascript" src="../../../../files/common.js"></script>
    <script type="text/javascript" src="../../../../files/highlight.js"></script>
    <script type="text/javascript" src="../../../../files/dynamic.js"></script>
    <script type="text/javascript" src="../../../../files/jruby.js"></script>
		
    
    <script type="text/javascript">
      hljs.initHighlightingOnLoad('ruby');
    </script>
    
    <!--[if lt IE 7.]><script defer type="text/javascript" src="/files/pngfix.js"></script><![endif]-->

    <link rel="alternate" type="application/atom+xml" title="Radarek bloguje... o Ruby - wpisy" href="http://feeds.feedburner.com/radarek-blog" />
    <link rel="alternate" type="application/atom+xml" title="Radarek bloguje... o Ruby - nagłówki" href="http://feeds.feedburner.com/radarek-blog/headers" />
    <link rel="alternate" type="application/atom+xml" title="Radarek bloguje... o Ruby - miniblog" href="http://feeds.feedburner.com/radarek-blog/miniblog" />
  </head>

  <body>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-837628-3']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
      })();
    </script>
  
    <div id="top">
      <a href="../../../../index.html" id="return-to-main">&nbsp;</a>
      <h3 id="sentence">
        <q>Any fool can make things bigger, more complex, and more violent. It takes a touch of genius and a lot of courage to move in the opposite direction.</q>
        Albert Einstein
      </h3>

      <div id="title-image">
        <div id="ruby-logo"></div>
        <h1>o Ruby</h1>
      </div><!-- title-image -->

      <div id="navigation-tabs">
        <ul id="tabs">
          <li class="active"><a href="../../../../index.html"><span>Wpisy</span></a></li>
          <li><a href="../../../04/29/o-blogu/index.html"><span>O blogu</span></a></li>
          <li><a href="../../../05/01/kanaly-rss/index.html"><span>RSS</span></a></li>
          <li><a href="../../../05/01/kontakt/index.html"><span>Kontakt</span></a></li>
        </ul><!-- tabs -->
      </div><!-- navigations-tabs -->
    </div><!-- top -->

    <div id="top-shadow"></div>

    <div id="content-wrapper">

      <div id="menu">       
        <div class="submenu">
          <form action="http://radarek.jogger.pl/szukaj/" method="post" id="search">
            <fieldset>
              <h3>Szukaj</h3>

              <input class="text" type="text" value="" name="search" /><input class="submit" type="submit" value="Szukaj" />
            </fieldset>
          </form>
        </div>

        <div class="submenu">
          <h3>Subskrypcje RSS</h3>
          <a href="http://feeds.feedburner.com/radarek-blog"><img src="http://feeds.feedburner.com/~fc/radarek-blog?bg=000000&amp;fg=FFFFFF&amp;anim=0" height="26" width="88" style="border: 0; vertical-align: middle; margin: 0;" alt="" /></a> (pełne wpisy)
          <br />
          <span style="position: relative; left: 2em;">+</span>
          <br />
          <a href="http://feeds.feedburner.com/radarek-blog/headers"><img src="http://feeds.feedburner.com/~fc/radarek-blog/headers?bg=000000&amp;fg=FFFFFF&amp;anim=0" height="26" width="88" style="border: 0; vertical-align: middle; margin: 0;" alt="" /></a> (nagłówki)
        </div>

        <div class="submenu">
          <object width="200" height="300" type="application/x-shockwave-flash" data="http://www.blip.pl/widget.swf">
            <param name="movie" value="http://www.blip.pl/widget.swf" />
            <param name="quality" value="high"/>
            <param name="wmode" value="transparent" />
            <param name="flashvars" value="blip_user=radarek&amp;color_scheme=dark&amp;corner_radius=0&amp;"/>
          </object>
        </div>


        <div class="submenu">
          <h3>Miniblog</h3>
          
          <div class="miniblog-post">
            <h4><a class="title" href="../../../../2009/01/01/gist-odpicowane-pastie/index.html">Gist - odpicowane pastie</a></h4>
            01 Sty 2009
            <div class="">
              <p>
  <a href="http://gist.github.com">Gist</a> istnieje już jakiś czas, dopiero teraz przyglądnąłem się mu bliżej. Początkowo wydawało mi się, że to kolejny klon <a href="http://pastie.org">pastie</a>, ale szybko okazało się, że to coś więcej.
</p>

<p>
  Coś więcej ponieważ Gist, prócz tego co potrafi Pastie (edycja pliku online, kolorowanie składni, prywatne pliki), dodaje to co potrafi najlepiej - obsługa repozytoriów <a href="http://git-scm.com/">Git</a>. Otóż każde nowe "pastie" powoduje założenie repozytorium gita, które następnie możemy pobrać (clone), a także wysyłać do niego zmiany (push). Oczywiście nie jesteśmy ograniczeni do 1 pliku, możemy mieć ich tyle ile chcemy. Na stronie pokazywana jest historia rewizji. Dbałość o szczegóły jest firmowym znakiem serwisu <a href="http://github.com">GitHub</a>. Żegnaj Pastie, niech żyje Gist!
</p>

              
            </div><!-- post-body -->
          </div>
          
          <div class="miniblog-post">
            <h4><a class="title" href="../../../../2008/10/12/mp3-przeboje/index.html">Mp3 Przeboje</a></h4>
            12 Paź 2008
            <div class="">
              <a href="http://mp3przeboje.pl">http://mp3przeboje.pl/</a> to serwis dzięki, któremu możesz odsłuchać aktualne najciekawsze utwory muzyczne prosto z przeglądarki. Po prosty wybierz interesującą Cię listę przebojów (aktualnie 22 listy z różnych stacji radiowych) i słuchaj. Programiście projektu <a href="http://md6.org/">oki</a>emu należą się słowa uznania za staranność wykonania (serwis w zasadzie dopiero wystartował i ciągle się rozwija).
              
            </div><!-- post-body -->
          </div>
          
        </div>

        <div class="submenu">
          <h3>Narzędzia</h3>

          <ul id="tools">
            <li><a href="javascript:irb_console.toggle();">JRuby irb console</a></li>
          </ul>
        </div>

        <div class="submenu">
          <h3>Kategorie</h3>

          <ul id="categories">
          
            <li id="blog"><a href="../../../../kategoria/blog/index.html">Blog (6)</a></li>
          
            <li id="c"><a href="../../../../kategoria/c/index.html">C (1)</a></li>
          
            <li id="gamedev"><a href="../../../../kategoria/gamedev/index.html">Gamedev (1)</a></li>
          
            <li id="git"><a href="../../../../kategoria/git/index.html">Git (2)</a></li>
          
            <li id="humor"><a href="../../../../kategoria/humor/index.html">Humor (3)</a></li>
          
            <li id="java"><a href="../../../../kategoria/java/index.html">Java (1)</a></li>
          
            <li id="jruby"><a href="../../../../kategoria/jruby/index.html">JRuby (2)</a></li>
          
            <li id="miniblog"><a href="../../../../kategoria/miniblog/index.html">Miniblog (8)</a></li>
          
            <li id="narzedzia"><a href="../../../../kategoria/narzedzia/index.html">Narzędzia (7)</a></li>
          
            <li id="programowanie"><a href="../../../../kategoria/programowanie/index.html">Programowanie (7)</a></li>
          
            <li id="python"><a href="../../../../kategoria/python/index.html">Python (4)</a></li>
          
            <li id="ruby"><a href="../../../../kategoria/ruby/index.html">Ruby (37)</a></li>
          
            <li id="ruby_merb"><a href="../../../../kategoria/ruby/merb/index.html">Merb (2)</a></li>
          
            <li id="ruby_ruby-on-rails"><a href="../../../../kategoria/ruby/ruby-on-rails/index.html">Ruby on Rails (6)</a></li>
          
            <li id="techblog"><a href="../../../../kategoria/techblog/index.html">Techblog (36)</a></li>
          
            <li id="tips-tricks"><a href="../../../../kategoria/tips-tricks/index.html">Tips &amp; tricks (9)</a></li>
          
            <li id="web"><a href="../../../../kategoria/web/index.html">Web (2)</a></li>
          
          </ul>
        </div>

        <div class="submenu">
          <h3>Tagi</h3>
          
            <a class="catlvl0" href="../../../../kategoria/blog/index.html">Blog</a>
          
            <a class="catlvl0" href="../../../../kategoria/c/index.html">C</a>
          
            <a class="catlvl0" href="../../../../kategoria/gamedev/index.html">Gamedev</a>
          
            <a class="catlvl0" href="../../../../kategoria/git/index.html">Git</a>
          
            <a class="catlvl0" href="../../../../kategoria/humor/index.html">Humor</a>
          
            <a class="catlvl0" href="../../../../kategoria/java/index.html">Java</a>
          
            <a class="catlvl0" href="../../../../kategoria/jruby/index.html">JRuby</a>
          
            <a class="catlvl1" href="../../../../kategoria/miniblog/index.html">Miniblog</a>
          
            <a class="catlvl1" href="../../../../kategoria/narzedzia/index.html">Narzędzia</a>
          
            <a class="catlvl1" href="../../../../kategoria/programowanie/index.html">Programowanie</a>
          
            <a class="catlvl0" href="../../../../kategoria/python/index.html">Python</a>
          
            <a class="catlvl3" href="../../../../kategoria/ruby/index.html">Ruby</a>
          
            <a class="catlvl0" href="../../../../kategoria/ruby/merb/index.html">Merb</a>
          
            <a class="catlvl0" href="../../../../kategoria/ruby/ruby-on-rails/index.html">Ruby on Rails</a>
          
            <a class="catlvl3" href="../../../../kategoria/techblog/index.html">Techblog</a>
          
            <a class="catlvl1" href="../../../../kategoria/tips-tricks/index.html">Tips &amp; tricks</a>
          
            <a class="catlvl0" href="../../../../kategoria/web/index.html">Web</a>
          
        </div>

        <div class="submenu">
          <h3>Linki</h3>
          <ul id="links">
            <li><a href="http://mp3przeboje.pl/">mp3 przeboje</a></li>
            <li><a href="http://linuxlinki.md6.org/">Linux linki</a></li>
          </ul>
        </div>

        <div class="submenu">
          <h3>Archiwum</h3>
          <ul id="archives">
            
              <li><a href="../../../../startid/470765.html">21.02.09-19.04.10
 (5)</a></li>
            
              <li><a href="../../../../startid/433510.html">08.12.08-12.02.09
 (5)</a></li>
            
              <li><a href="../../../../startid/425293.html">21.11.08-06.12.08
 (5)</a></li>
            
              <li><a href="../../../../startid/423490.html">27.05.08-20.11.08
 (5)</a></li>
            
              <li><a href="../../../../startid/392066.html">12.03.08-21.04.08
 (5)</a></li>
            
              <li><a href="../../../../startid/383421.html">25.11.07-01.03.08
 (5)</a></li>
            
              <li><a href="../../../../startid/364188.html">12.10.07-20.11.07
 (5)</a></li>
            
              <li><a href="../../../../startid/337815.html">29.05.07-20.07.07
 (5)</a></li>
            
              <li><a href="../../../../startid/323920.html">05.05.07-28.05.07
 (5)</a></li>
            
          </ul>
        </div>

      </div><!-- menu -->

      <div id="content">
        <div class="translation-info" style="display: none;">
          <script type="text/javascript" src="http://www.gmodules.com/ig/ifr?url=http://www.google.com/ig/modules/translatemypage.xml&amp;up_source_language=pl&amp;w=160&amp;h=60&amp;title=&amp;border=&amp;output=js"></script>
          <h4>Looking for english version of this blog?</h4>
          <p>
          Hello Stranger! This page is written in polish language and it looks like your is different than that.
          Currently I cannot afford english version of this page. The easiest way to (at least try) read this page on another language is to use automatic Google Translator. Thanks for visit!
          </p>
          <div style="clear: left;"></div>
        </div>

        <div style="margin-bottom: 1em;">
          <script type="text/javascript" id="AdTaily_Widget" src="http://static.adtaily.pl/widget.js#foobarbaz"></script>
          <noscript><p><a href="http://www.adtaily.pl">Skuteczna reklama na blogach sprzedawana za pomocą AdTaily</a>(PLALLADTAILY0002)</p></noscript>
        </div>

        <div class="post">

          <div class="post-header">
            <div class="post-date">
              <small>2007</small>
              <span>12</span>
              <small>Paź</small>
            </div><!-- post-date -->
            <h2 class="post-title"><a class="title" href="index.html">Idiomatyczny Ruby</a></h2>
            
            <a href="index.html#comments">5 komentarzy</a>
            | Kategorie:
            
              <a class="strong" href="../../../../kategoria/ruby/index.html">Ruby,</a>
            
              <a class="strong" href="../../../../kategoria/techblog/index.html">Techblog,</a>
            
              <a class="strong" href="../../../../kategoria/tips-tricks/index.html">Tips &amp; tricks</a>
            
            
              | <a href="trackback/index.html">trackback</a>
            
            

            
            <br />
              Tagi:
                
                  <a class="strong" href="http://technorati.com/tags/idioms" rel="tag">
                  idioms</a>
                
                  <a class="strong" href="http://technorati.com/tags/ruby" rel="tag">
                  ruby</a>
                
                  <a class="strong" href="http://technorati.com/tags/tips" rel="tag">
                  tips</a>
                
            
          </div><!-- post-header -->

          <div class="post-body">
            <p>
Na wstępie chciałbym Was powitać po dłuższej przerwie. Zleciały wakacje, zleciał wrzesień a ja nie zmusiłem się do napisania ani jednego wpisu. Wynika to z mojego podejścia do pisania. Otóż każdy wpis traktowałem dosyć poważnie i zawsze chciałem napisać coś sensownego co w praktyce oznaczało obszernego (wystarczy spojrzeć na poprzednie wpisy). Napisanie jednego artykułu trwało kilka (a nawet więcej) godzin. W najbliższej przyszłości prawdopodobnie się to zmieni i pojawiać się będą także bardzo krótkie wpisy, ale się zobaczy :). To tyle tytułem wstępu.
</p>

<h3>Świat idiomów</h3>
<p>
W dzisiejszym wpisie postaram się przybliżyć Wam temat idiomów (nie mylić z idiotami;)), ze szczególnym uwzględnieniem Rubiego rzecz jasna (niech nie zmyli Was wstęp, to nie jest rozprawka na język polski! :D). Zacznijmy od wstępu teoretycznego. Cytując za <a href="http://pl.wikipedia.org/wiki/Idiom">Wikipedią</a>:
</p>



<blockquote>
<p>
<strong>Idiom, idiomat, idiomatyzm</strong> – wyrażenie językowe (najczęściej kilkuwyrazowe) którego znaczenie jest inne niż by to wynikało ze znaczenia poszczególnych wyrazów wchodzących w skład idiomu oraz z reguł językowych.
</p>

<p>
O idiomach najczęściej wspomina się w kontekście nauki języków obcych (ponieważ stanowią one liczną grupę wyjątków od poznawanych przez uczącego się reguł), stąd też bardzo często stosuje się inną definicję:
</p>

<p>
<strong>Idiom</strong> – wyrażenie właściwe tylko danemu językowi, nie dające się dosłownie przetłumaczyć na inny język.
</p>

<p>
Przykłady polskich idiomów
</p>

<ul id="idioms" style="list-style-type: square;">
  <li>piąte koło u wozu 'osoba lub rzecz zawadzająca'</li>
  <li>urwanie głowy 'bezładny pośpiech'</li>
</ul>
</blockquote>

<p>
Po co nam idiomy? Ponieważ używając ich dostajemy wiele korzyści. Możemy wyrazić w bardzo zwięzły sposób coś, czego opisanie przy użyciu "normalnych" słów zajęłoby nam dłużej ("O wilku mowa" zamiast "Ooo, cześć. Wiesz właśnie o Tobie rozmawialiśmy"). Dają nam także nowy zasób słownictwa, są zastępstwem innych wyrażeń ("Mam tyle co kot napłakał" zamiast "Mam niewiele"). A że <a href="http://pl.wikipedia.org/wiki/Jan_Miodek">profesor Miodek</a> ze mnie marny, na tym poprzestanę.
</p>

<h3>Wtf?</h3>
<p>
Czy to co napisałem do tej pory ma coś wspólnego z programowaniem? Gdyby nie miało to nie pisałbym ;). Programując używamy języków programowania. A te jak inne języki rządzą się podobnymi prawami (co nie oznacza, że takimi samymi). Ponieważ idiomy to zlepek innych słów, istnieją także i w językach programowania. Możliwe, że używamy ich nie wiedząc o tym. Dla przykładu, chcąc napisać nieskończoną pętlę w języku C zazwyczaj napiszemy:
</p>

<pre>
<code class="C">while (1) {
  //kod
}
</code>
</pre>

<p>
Ale możemy także napisać:
</p>

<pre>
<code class="C">for (;;) {
  //kod
}
</code>
</pre>

<p>
Oba rozwiązania są równoważne. To pierwsze rozwiązanie można by określić jako typowe, to drugie jako idiomatyczne, tym bardziej, że pętla for kojarzy się z pętla o konkretnej liczbie kroków, dających się wyznaczyć jeszcze przed uruchomieniem pętli. Ciekawą rzeczą jest tu fakt, że niewprawiony programista może mieć problemy ze zrozumieniem tej drugiej konstrukcji. Nie wygląda ona jak typowa pętla <code>for</code> (<code>for (x = 0; x < 10; x++)</code>), a zlepione średniki mogą wprowadzić irytuację. Zwracam na to uwagę, gdyż znajomość języka nie oznacza automatycznej znajomości idiomów. Odczuć to można na własnej skórze ucząc się języka obcego. Ma to dokładnie takie samo znaczenie w przypadku programowania. Idiomy dają nowe możliwości, ale nic za darmo. Musimy poświęcić im troszkę czasu.
</p>

<h3>Idiomy Rubiego</h3>
<p>
Szczerze mówiąc z idiomami (jeśli chodzi o programowanie) spotkałem się dopiero w Rubym. Wydaje mi się, że jest to spowodowane tym iż język ten zwiera takie elementy, które są niespotykane (albo nie są tak bardzo popularne). Do tej pory trochę przynudziłem (nie śpijcie jeszcze;)), teraz przejdę do konkretnych przykładów, porównując różne podejścia do tego samego problemu (pojawią się też inne języki niż Ruby).
</p>

<p>
Chcąc zadeklarować prostą klasę, z jednym atrybutem moglibyśmy napisać tak (wzorując się np. na Javie, C++):
</p>

<pre><code class="ruby">class SomeClass
  def attr
    @attr
  end

  def attr=(attr)
    @attr = attr
  end
end
</code></pre>

<p>
Ale oczywiście lepiej jest zrobić tak (chodź w tym wypadku zahaczamy także o tematykę DSL, ale o tym innym razem):
</p>

<pre><code class="ruby">class SomeClass
  attr_accessor :attr
end
</code></pre>

<p>
Chcąc napisać funkcję (metodę) która przyjmuje dowolną liczbę argumentów w języku C moglibyśmy napisać tak:
</p>

<pre><code class="C">#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void print_nums(int count, ...)
{
  va_list ap;
  int i;

  va_start(ap, count); /* Initialize the argument list. */

  for (i = 0; i &lt; count; i++)
  {
    int num = va_arg(ap, int); /* Get the next argument value. */
    printf("%d\n", num);
  }

  va_end(ap); /* Clean up. */
}

main()
{
  print_nums(3, 102, 5, 689);
}
</pre></code>

<p>
W Rubym znacznie prościej:
</p>

<pre><code class="ruby">def print_nums(*numbers)
  numbers.each {|n| puts n }
end

print_nums(1, 2, 3, 4)
</code></pre>

<p>
Chcemy zwrócić lub przypisać nową wartość do zmiennej w zależności od tego czy inna zmienna ma wartość obliczana jest jako prawda lub fałsz.
</p>

<pre><code class="ruby">if myvar
  return myvar
else
  return another_value
end
</code></pre>

<p>
Lepiej jest jednak napisać:
</p>

<pre><code class="ruby">return myvar || another_value
</code></pre>

<p>
Chcemy przypisać nową wartość zmiennej, jeśli jej wartość obliczana jest jako fałsz.
</p>

<pre><code class="ruby">if not breakfast
  breakfast = :bacon
end

#albo

breakfast = :bacon unless breakfast
</code></pre>

<p>
Jednak wprawny programista Rubiego napisze:
</p>

<pre><code class="ruby">breakfast ||= :bacon
</code></pre>

<p>Ten sposób jest bardzo często wykorzystywane w metodach zwracających jakąś wartość, która musi wpierw być obliczona.
<pre><code class="ruby">def current_user
  return @current_user ||= User.find(session[:id]) #uwaga na wyjątek jeśli session[:id] zwróci nil
end
</code></pre>

<p>
Chcemy do pliku dołączyć pewną część kodu, która zostanie uruchomiona tylko wtedy gdy plik został wywołany bezpośrednio (ruby plik.rb) a nie poprzez require czy load. (W ten sposób można dołączyć np. testy bezpośrednio w kodzie.) Użyjemy zmiennej $0 lub jej aliasu $PROGRAM_NAME.
</p>

<pre><code class="ruby">if $PROGRAM_NAME == __FILE__ #
    do_stuff
end
</code></pre>

<p>
Niesamowicie idiomatyczne są bloki kodu w Rubym. Oto kilka przykładów. Bardzo często wykonując pewne operacje pracujemy na pewnych zasobach. Zasobem może być w zasadzie cokolwiek. Najbardziej typowym przykładem jest baza, plik, gniazdo (socket). Zasób taki wpierw pozyskujemy, następnie wykonujemy na nim jakieś operacje (zapis danych, odczyt) i oddajemy (dzięki czemu system odzyskuje z powrotem zasoby. Wydawać by się mogło, że nie ma tu nic czego mielibyśmy się obawiać. To na co musimy zawsze zwrócić uwagę to ten 3 (najważniejszy) krok - zwolnienie zasobu. Nawet jeśli w kodzie umieścimy odpowiednie operacje zwalniające, nie mamy gwarancji, że tak się stanie (np. rzucony i nieobsłużony wyjątek już po otwarciu pliku, a przed jego zamknięciem). I tu właśnie należy wręcz skorzystać z następującego rozwiązania:
</p>

<pre><code class="ruby">class Resource
  def self.open(identifier)
    resource = Resource.new(identifier)
    yield resource
  ensure
    resource.close
  end

  def close
    #...
  end
end

Resource.open(identifier) do |resource|
   process(resource)
end

# zasób jest zamknięty, nawet jeśli pojawił się wyjątek
</code></pre>

<p>
Wygląda znajomo? Powinno :). Takie rozwiązanie zastosowano w klasie File.
</p>

<pre><code class="ruby">File.open("plik.txt", "w") do |file|
  #...
end
# nie martwimy się o zamknięcie pliku
</code></pre>

<p>
Jeśli chcemy obsłużyć zarówno klasycznie otwarcie zasobu (bierzemy odpowiedzialność za jego zamknięcie) jak i to powyższe napiszemy coś takiego:
</p>

<pre><code class="ruby">
def Resource.open(identifier)
 resource = Resource.new( identifier )
 if block_given?
   begin
     yield resource
   ensure
     resource.close
   end
 else
   return resource
 end
end

r = Resource.open(x)
#...
r.close

#lub

Resource.open(x) do |r|
 #...
end
</code></pre>

<p>
Bloki (nawet jeśli chodzi o sam wygląd w kodzie) bardzo ładnie reprezentują tranzakcje. Spójrz proszę na kod:
</p>

<pre><code class="ruby">Account.transaction(david, mary) do
  david.withdrawal(100)
  mary.deposit(100)
end
</code></pre>

<p>
Jeśli podczas wywołania tego bloku wystąpi wyjątek, tranzakcja zostanie odwołana. To jest o tyle piękne, że w tradycyjnym podejściu postępowalibyśmy tak: otworzyć trazakcję, wykonać operacje, zamknąć tranzakcję. W tym wypadku nie dość, że omijamy pierwszy i ostatni krok (automatycznie) to jeszcze sam blok w pięknie obrazuje nam znaczenie tranzakcji (albo cały blok, albo nic).
</p>

<p>
Następny przykład. Chcemy z dwóch liczb wybrać większą (bądź mniejszą) i zwrócić ją. Klasycznie zrobimy tak:
</p>

<pre><code class="ruby">def maximum(a, b)
  if a > b
    return a
  else
    return b
  end
end
</code></pre>

<p>
Jednakże idiomatycznie będzie tak (a także krócej, czytelniej!):
</p>

<pre><code class="ruby">def maximum(a, b)
  return [a, b].max # czy to w ogóle wymaga komentarza?
end
</code></pre>

<p>
Takich przykładów można podawać mnóstwo. Na koniec podam przykład idiomu, na który natknąłem się dosyć niedawno, a który bardzo mi się spodobał. Chodzi o sytuację, kiedy chcemy wywołać jakąś metodę i zapamiętać zwróconą wartość. Jeśli wywołanie nie powiedzie się (wyjątek) chcemy wywołać jakąś inną metodę (może być wiele takich metod). Klasycznie zrobilibyśmy to tak:
</p>

<pre><code class="ruby">value = nil
begin
  value = do_something1
rescue => e
  begin
    value = do_something2
  rescue => e
    #...
  end
end
</code></pre>

<p>
Ale po co tak robić jak można tak:
</p>

<pre><code class="ruby">value = do_something1 rescue do_something2 rescue "sorry"
</code></pre>

<p>
Idiomów jest znacznie więcej i nie jestem w stanie ich tu podać wszystkich :). Ważne jest to, żeby znać te najczęściej stosowane, gdyż ułatwia nam to wspólne porozumiewanie się. Na koniec podaję dodatkowe źródła, do których przeglądnięcia bardzo zachęcam :). Czekam też na Wasze ulubione idomy, niekoniecznie te Rubinowe.
</p>

<h3>Zasoby</h3>
<p>
<a href="http://www.rubygarden.org/ruby/page/show/RubyIdioms">http://www.rubygarden.org/ruby/page/show/RubyIdioms</a><br />
<a href="http://renaud.waldura.com/doc/ruby/idioms.shtml">http://renaud.waldura.com/doc/ruby/idioms.shtml</a><br />
<a href="http://podcast.sdruby.com/2007/1/16/episode-014-ruby-idioms-part-1">http://podcast.sdruby.com/2007/1/16/episode-014-ruby-idioms-part-1</a><br />
</p>
          </div><!-- post-body -->
        </div><!-- post -->
        <div class="separator"></div>
        
        <div class="wykop" style="padding: 1px;" >
          <p style="margin-top: 10px;">
          Jeśli spodobał Ci się wpis to może umieścisz ten blog w swoim czytniku RSS?
          </p>
        </div>
        <div style="clear: left;"></div>

        

        
        <h3>Komentarze</h3>
        

        <div id="comments">
        
          <div id="comment-976254" class="comment1 guest">
            
            1.
            
            
            <img class="avatar-icon" src="../../../../files/default-avatar-icon.png" alt="avatar icon" />
            
            <strong>Musk</strong> napisał(a) 13 Paź 2007 o godz. 20:16:
            <div class="top"></div>
            <div class="content">
              <p>Przydatny wpis, ciekawe przykłady :). Jesteś w moim czytniku.</p>
            </div>
            <div class="footer"></div>
          </div>
        
          <div id="comment-976258" class="comment2 owner">
            
            2.
            
            <img class="avatar-icon" src="../../../../files/favicon.png" alt="avatar icon" />
            
            
            <strong><a href="../../../../index.html">Radarek</a></strong> napisał(a) 13 Paź 2007 o godz. 20:21:
            <div class="top"></div>
            <div class="content">
              <p>Przykładów jest znacznie więcej &#8211; zaglądnij do linków, które podałem na końcu :).</p>
            </div>
            <div class="footer"></div>
          </div>
        
          <div id="comment-990106" class="comment1 guest">
            
            3.
            
            
            <img class="avatar-icon" src="../../../../files/default-avatar-icon.png" alt="avatar icon" />
            
            <strong>T.M.S</strong> napisał(a) 29 Paź 2007 o godz. 12:38:
            <div class="top"></div>
            <div class="content">
              <p>Ciekawy post. Good job !</p>
            </div>
            <div class="footer"></div>
          </div>
        
          <div id="comment-1001714" class="comment2 guest">
            
            4.
            
            
            <img class="avatar-icon" src="../../../../files/default-avatar-icon.png" alt="avatar icon" />
            
            <strong>kotosha</strong> napisał(a) 12 Lis 2007 o godz. 13:44:
            <div class="top"></div>
            <div class="content">
              <p>Naprawdę przydatny artykuł. Piszę pracę licencjacką o Ruby i często zaglądam na Twoją stronę. Tak trzymać:)</p>
            </div>
            <div class="footer"></div>
          </div>
        
          <div id="comment-1001715" class="comment1 owner">
            
            5.
            
            <img class="avatar-icon" src="../../../../files/favicon.png" alt="avatar icon" />
            
            
            <strong><a href="../../../../index.html">Radarek</a></strong> napisał(a) 12 Lis 2007 o godz. 13:46:
            <div class="top"></div>
            <div class="content">
              <p>@kotosha, dzięki za słowa uznania :). Ruby na tym blogu króluje i nie zamierzam tego zmieniać.</p>
            </div>
            <div class="footer"></div>
          </div>
        
        </div><!-- comments -->

        

        

        

        
        <h3>Musisz się zalogować, jeśli chcesz dodać komentarz.</h3>
        
      </div><!-- content -->

      <div class="cleaner"></div>

    </div><!-- content-wrapper -->

    <div id="footer" style="clear: both;">
    <div id="footer-shadow"></div>
        <h3>Czytelnicy</h3>
        <script type="text/javascript" src="http://pub.mybloglog.com/comm2.php?mblID=2007050116063791&amp;c_width=800&amp;c_sn_opt=n&amp;c_rows=3&amp;c_img_size=f&amp;c_heading_text=&amp;c_color_heading_bg=FFFFFF&amp;c_color_heading=000000&amp;c_color_link_bg=FFFFFF&amp;c_color_link=000000&amp;c_color_bottom_bg=FFFFFF"></script>
      <div id="bottom-para">
        <p>
          &copy; 2007-2010, Radarek bloguje. Graphics, css, xhtml, javascript code by <a href="../../../../index.html">Radarek</a>
          | <a href="http://validator.w3.org/check/referer">Valid XHTML 1.0 Strict</a>
          | <a href="http://jigsaw.w3.org/css-validator/check/referer">Valid CSS</a>
        </p>
      </div>
    </div><!-- footer -->

    <div id="jruby-irb-console" style="display: none;">
      <div class="overlay">
        <div class="window">
          <div class="inner">
            <a class="close-popup" href="index.html#">Zamknij</a>
            <div class="irb-console-applet">
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--</div>-->
  </body>
</html>